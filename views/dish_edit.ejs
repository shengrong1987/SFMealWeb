
<div class="container-fluid text-center" style="margin-top:-20px;">
  <div class="row">
    <div class="pure-banner vertical-align green">
      <div class="middle banner-text">
        <div class="vertical-align" style="margin-bottom: 5px;">
          <div class="col-sm-3 relative text-left">
            <a href="/" class="logo logo-sm"></a>
          </div>
          <div class="col-sm-9">
            <h4 class="text-white"><strong><%= __('welcome') %></strong></h4>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">

    <div class="default-container">
      <ul class="nav nav-tab-green nav-justified" style="padding: 20px;">
        <li><a href="/host/me#myorder"><h4><strong><%= __('host-nav-order') %></strong></h4></a></li>
        <li><a href="/host/me#mymeal"><h4><strong><%= __('host-nav-meal') %></strong></h4></a></li>
        <li class="active"><a href="/host/me#mydish"><h4><strong><%= __('host-nav-dish') %></strong></h4></a></li>
        <li><a href="/host/me#myinfo"><h4><strong><%= __('host-nav-info') %></strong></h4></a></li>
      </ul>

      <div id="dishEditView" style="margin: auto;">
        <div class="box box-shadow box-primary white text-left">
          <h1></h1>
          <form data-id="<%= dish.userId%>" data-dish-id="<%= dish.id%>" data-err-container=".submit" data-toggle="validator">
            <div class="form-group">
              <label for="mealTitleInput">1.<%= __('dish-name') %></label>
              <input id="mealTitleInput" class="form-control" type="text" placeholder="<%= __('full-name') %>" maxlength="7" data-error="<%= __('full-name') %>" required value="<%= dish.title%>">
              <div class="help-block with-errors"></div>
            </div>

            <div class="form-group photo">
              <label style="display: block;" for="">2.<%= __('photos') %><span class="text-grey">(<%= __('photosTip')%>)</span></label>
              <%
                var photos = dish.photos;
                for(var i = 1; i <= 3; i++){
                  var photo = photos[i-1];
                  if(photo && photo.v != ""){
              %>
                <div class="fileinput fileinput-exists form-group" data-provides="fileinput" data-index="<%= i%>">
                  <div class="fileinput-new thumbnail" style="width: 200px; height: 150px;">
                  </div>
                  <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px;" data-src="<%= photo.v%>">
                    <img src="<%= photo.v%>">
                  </div>
                  <div>
                    <div class="btn btn-default btn-file"><span class="fileinput-new"><%= __('select-image')%></span><span class="fileinput-exists"><%= __('change')%></span>
                      <input id="photoInput-<%= i%>" class="form-control" type="file" data-strictImage=true name="image">
                    </div>
                    <a href='javascript:void(0)' class="btn btn-default fileinput-exists dimiss" data-dismiss="fileinput"><%= __('remove')%></a>
                    <script>
                      $(".fileinput").on("clear.bs.fileinput",function(){
                        var index = $(this).data("index");
                        $("#photoInput-" + index).data("isDelete",true);
                      });
                    </script>
                  </div>
                  <div class="help-block with-errors"></div>
                </div>
              <%}else{%>
                <div class="fileinput fileinput-new" data-provides="fileinput">
                  <div class="fileinput-new thumbnail" style="width: 200px; height: 150px;"></div>
                  <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px;"></div>
                  <div>
                    <div class="btn btn-default btn-file"><span class="fileinput-new"><%= __('select-image')%></span><span class="fileinput-exists"><%= __('change')%></span>
                      <input id="photoInput-<%= i%>" type="file" data-strictImage=true>
                    </div>
                    <a href="javascript:$(this).prev().find('input').data('delete',true);" class="btn btn-default fileinput-exists" data-dismiss="fileinput"><%= __('remove')%></a>
                  </div>
                </div>
              <%}}%>
              <div id="photoError" class="help-block with-errors text-red"></div>
              <div class="alert alert-info"><%= __('need-three-photos') %></div>
            </div>

            <div class="form-group">
              <label for="priceInput">3.<%= __('how-much-for-one') %></label>
              <div class="input-group" style="width: 250px;">
                <div class="input-group-addon">$</div>
                <input type="text" class="form-control" id="priceInput" placeholder="<%= __('dollar') %>" min="1" max="100" data-error="<%= __('price-incorrect') %>" required value="<%= dish.price%>">
                <div class="input-group-addon">.00</div>
              </div>
              <div class="help-block with-errors"></div>
            </div>

            <div class="form-group">
              <label for="priceInput">4.<%= __('how-many-for-one') %></label>
              <div class="input-group" style="width: 250px;">
                <input type="text" class="form-control" id="quantityInput" placeholder="<%= __('fenliang') %>" value="<%= dish.quantity || ''%>">
              </div>
            </div>

            <div class="form-group">
              <label for="categoryInput">5.<%= __('what-kind') %></label>
              <div class="dropdown">
                <button class="btn btn-default dropdown-toggle btn-outline" type="button" id="categoryInput" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" value="<%= dish.type%>" data-selected="true">
                  <% switch(dish.type){
                    case "appetizer": %>
                  <%= __('appetizer') %>
                  <%break;
                    case "entree": %>
                  <%= __('main') %>
                  <%break;
                    case "dessert": %>
                  <%= __('dessert') %>
                  <%}%>
                  <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                  <li class="active"><a href="javascript:void(0)" value="entree"><%= __('main') %></a></li>
                  <li><a href="javascript:void(0)" value="appetizer"><%= __('appetizer') %></a></li>
                  <li><a href="javascript:void(0)" value="dessert"><%= __('dessert') %></a></li>
                </ul>
              </div>
            </div>

            <div class="form-group">
              <label for="desciptionInput">6.<%= __('dish-description') %></label>
              <div class="input-group" style="width:100%;max-width: 600px;">
                <textarea class="form-control" id="descriptionInput" maxlength="200" style="height: 150px;"><%= dish.description || ''%></textarea>
              </div>
            </div>

            <div class="form-group variation">
              <label for="dishVariationInput">7.<%= __('dish-variation') %></label>
              <div class="currentVar">
                <% var variations = Object.keys(dish.preference).forEach(function(variation){ var props = dish.preference[variation]; %>
                <div class="row option" data-value="<%= variation%>">
                  <div class="col-xs-3">
                    <h3><%= __(variation)%></h3>
                    <a class="deleteBtn" href="javascript:void(0);" data-value=<%= variation%>><%= __('delete')%></a>
                  </div>
                  <div class="col-xs-9">
                    <table class="table table-bordered">
                      <thead>
                        <tr class="active">
                          <td><%= __('property')%></td>
                          <td><%= __('price')%></td>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <div class="dropdown">
                              <a class="btn btn-default btn-outline dropdown-toggle property" type="button" data-toggle="dropdown" data-selected="true" aria-haspopup="true" aria-expanded="true" value="">
                                <span data-toggle="i18n" data-key="addVariation"></span>
                                <span class="caret"></span>
                              </a>
                              <ul class="dropdown-menu" aria-labelledby="dLabel">
                                <%
                                  var varSets = {
                                    "spicy" : ['mild', 'littleSpicy','regularSpicy','verySpicy','insaneSpicy'],
                                    "sweetness" : ['noSugar','halfSugar','regularSugar','extraSugar'],
                                    "icy" : ['noIce', 'halfIce', 'regularIce', 'extraIce'],
                                    "ingredient" : [],
                                    "wellness" : ['rare','mediumRare','medium','mediumWell', 'wellDone']
                                  }
                                  if(varSets[variation] && varSets[variation].length > 0 ) { varSets[variation].forEach(function (option) { %>
                                    <li><a href="javascript:void(0);" data-toggle="i18n" data-key="<%= option%>" value="<%= option%>"></a></li>
                                <%});} %>
                                <li class="disabled"><a><%= __('noOption')%></a></li>
                                <li><a href="javascript:void(0);" value="custom"><%= __('customizedOption')%></a></li>
                              </ul>
                            </div>
                          </td>
                          <td>
                            <% props.forEach(function(property){ %>
                              <tr class="customProperty">
                                <td><%= property%><i class="fa fa-close reset cursor-pointer" data-value="<%= property%>" style="float: right;" href="javascript:void(0)"></i></td>
                                <td></td>
                              </tr>
                            <% });%>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <% })%>
              </div>
              <div class="dropdown">
                <a id="dishVariationInput" class="btn btn-default btn-outline dropdown-toggle" type="button" data-toggle="dropdown" data-selected="true" aria-haspopup="true" aria-expanded="true" value="">
                  <span><%= __('add-variation')%></span>
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" aria-labelledby="dLabel">
                  <li><a href="javascript:void(0);" value="spicy"><%= __('spicy') %></a></li>
                  <li><a href="javascript:void(0);" value="sweetness"><%= __('sweetness') %></a></li>
                  <li><a href="javascript:void(0);" value="icy"><%= __('icy') %></a></li>
                  <li><a href="javascript:void(0);" value="ingredient"><%= __('ingredient') %></a></li>
                  <li><a href="javascript:void(0);" value="wellness"><%= __('wellness') %></a></li>
                  <li class="disabled"><a><%= __('cant-find-option')%></a></li>
                  <li><a href="javascript:void(0);" value="custom"><%= __('add-custom-option')%></a></li>
                </ul>
              </div>
              <div class="customVar"></div>
            </div>

            <div class="form-group">
              <label for="instagramInput">8.<%= __('dish-instagram') %></label>
              <input type="text" id="instagramInput" class="form-control" value="<%= dish.video || ''%>">
            </div>

            <div class="form-group text-center submit">
              <button type="submit" class="btn btn-green btn-lg round"><%= __('save-and-submit')%></button>
              <div class="help-block with-errors"><%= __('24hours')%></div>
              <div class="alert alert-danger" data-toggle="alert"></div>
              <div class="alert alert-success"></div>
            </div>

          </form>

        </div>
      </div>

    </div>
  </div>
</div>

<script>
  var dishView = new DishView({ el : $("#dishEditView"), model : new Dish()})
</script>
